library(readxl)
#Reading in excel file
clinic <- read_excel("clinical_data.xlsx")
?read_excel
clinic_key <- read_excel("clinical_data.xlsx", sheet = 2)
View(clinic_key)
View(clinic)
case_when(
clinic$sex == 1 ~ "male",
clinic$sex == 1 ~ "female"
)
library(tidyverse)
library(survival)
library(survminer)
library(reshape)
library(stringr)
library(dplyr)
library(ggplot2)
library(readxl)
case_when(
clinic$sex == 1 ~ "male",
clinic$sex == 1 ~ "female"
)
case_when(
clinic$sex == 1 ~ "male",
clinic$sex == 2 ~ "female"
)
clinic$clinrisk_score
#Good colnames
names(clinic)
dput(names(clinic))
#Good colnames
names(clinic) <- c("PID", "scout_name", "age", "sex", "is_comorbidity",
"is_prior_chemo", "risk_score",
"risk_cat", "is_extrahep_disease",
"is_steatosis",
"is_sinusoidal_dilatation",
"NASH_score", "is_NASH",
"is_NASH_4_plus", "percent_response",
"percent_necrosis", "percent_fibrosis",
"is_fibrosis_40_percent_plus",
"is_mucin", "OS_months", "vital_status",
"is_recurrence",
"DFS_months", "vital_status_DFS",
"is_recurrence_in_liver",
"liver_DFS_months", "vital_status_liver_DFS",
"relevant_notes")
cbind(clinic$vital_status, clinic$vital_status_DFS, clinic$vital_status_liver_DFS)
cbind(clinic$vital_status, clinic$vital_status_DFS, clinic$is_recurrence, clinic$vital_status_liver_DFS, clinic$is_recurrence_in_liver)
View(clinic)
cbind(clinic$vital_status, clinic$vital_status_DFS)
cbind(clinic$vital_status, cbind$recurrence, clinic$vital_status_DFS)
cbind(clinic$vital_status, clinic$recurrence, clinic$vital_status_DFS)
cbind(clinic$vital_status, clinic$is_recurrence, clinic$vital_status_DFS)
table(cbind(clinic$vital_status, clinic$is_recurrence, clinic$vital_status_DFS))
distinct(cbind(clinic$vital_status, clinic$is_recurrence, clinic$vital_status_DFS))
distinct(cbind.data.frame(clinic$vital_status, clinic$is_recurrence, clinic$vital_status_DFS))
#Comorbidity Presence?
clinic$is_comorbidity <- case_when(
clinic$is_comorbidity == 1 ~ "yes",
clinic$is_comorbidity == 0 ~ "no"
)
clinic$is_comorbidity
#Prior Chemo?
clinic$is_prior_chemo <- case_when(
clinic$is_prior_chemo == 1 ~ "yes",
clinic$is_prior_chemo == 0 ~ "no"
)
clinic$is_prior_chemo
clinic$is_extrahep_disease
#Extrahepatic Disease
clinic$is_extrahep_disease <- case_when(
clinic$is_extrahep_disease == 1 ~ "yes",
clinic$is_extrahep_disease == 0 ~ "no"
)
clinic$is_extrahep_disease
#Presence of steatosis
clinic$is_steatosis <- case_when(
clinic$is_steatosis == 1 ~ "yes",
clinic$is_steatosis == 0 ~ "no"
)
clinic$is_steatosis
#Presence of dilated sinousoids
clinic$is_sinusoidal_dilatation <- case_when(
clinic$is_sinusoidal_dilatation == 1 ~ "yes",
clinic$is_sinusoidal_dilatation == 0 ~ "no"
)
clinic$is_sinusoidal_dilatation
#Presence of NASH
clinic$is_NASH <- case_when(
clinic$is_NASH == 1 ~ "yes",
clinic$is_NASH == 0 ~ "no"
)
clinic$is_NASH
#Is Nash score at least 4
clinic$is_NASH_4_plus <- case_when(
clinic$is_NASH_4_plus == 1 ~ "yes",
clinic$is_NASH_4_plus == 0 ~ "no"
)
clinic$is_NASH_4_plus
case_when(
clinic$risk_score == -999 ~ NA,
clinic$risk_score
)
case_when(
clinic$risk_score == -999 ~ NA,
clinic$risk_score ~ clinic$risk_score
)
case_when(
clinic$risk_score == -999 ~ NA,
.default = clinic$risk_score
)
case_when(
clinic$risk_score == -999 ~ NA,
.default ~ clinic$risk_score
)
case_when(
clinic$risk_score == -999 ~ NA,
TRUE ~ clinic$risk_score
)
case_when(
clinic$risk_score == -999 ~ NA,
TRUE ~ clinic$risk_score
)
case_when(
clinic$risk_score == -999 ~ NA,
TRUE ~ as.numeric(clinic$risk_score)
)
case_when(
clinic$risk_score == -999 ~ NA,
TRUE ~ as.character(clinic$risk_score)
)
case_when(
clinic$risk_score == -999 ~ NA_integer_,
TRUE ~ clinic$risk_score
)
case_when(
clinic$risk_score == -999 ~ NA_real_,
TRUE ~ clinic$risk_score
)
clinic$risk_cat
case_when(
clinic$risk_cat == 1 ~ "high",
clinic$risk_cat == 0 ~ "low",
clinic$risk_cat == -999 ~ NA_character_
)
#Stratified clinic risk score
clinic$risk_cat <- case_when(
clinic$risk_cat == 1 ~ "high",
clinic$risk_cat == 0 ~ "low",
clinic$risk_cat == -999 ~ NA_character_
)
clinic$NASH_score
clinic$percent_response
case_when(
clinic$percent_response == -999 ~ NA_real_,
TRUE ~ clinic$percent_response
)
#Percent of total response
clinic$percent_response <- case_when(
clinic$percent_response == -999 ~ NA_real_,
TRUE ~ clinic$percent_response
)
#Is fibrosis greater than 40 percent
clinic$is_fibrosis_40_percent_plus <- case_when(
clinic$is_fibrosis_40_percent_plus == 1 ~ "high",
clinic$is_fibrosis_40_percent_plus == 0 ~ "low",
clinic$is_fibrosis_40_percent_plus == -999 ~ NA_character_
)
clinic$is_fibrosis_40_percent_plus
clinic$percent_fibrosis
#Percent of Fibrosis
clinic$percent_fibrosis <- case_when(
clinic$percent_fibrosis == -999 ~ NA_real_,
TRUE ~ clinic$percent_fibrosis
)
#Percent of tumor necrosis
clinic$percent_necrosis <- case_when(
clinic$percent_necrosis == -999 ~ NA_real_,
TRUE ~ clinic$percent_necrosis
)
clinic$percent_necrosis
clinic$percent_fibrosis
clinic$percent_response
clinic$is_mucin
#Is mucin present
clinic$is_mucin <- case_when(
clinic$percent_fibrosis == -999 ~ NA_real_,
TRUE ~ clinic$percent_fibrosis
)
library(tidyverse)
library(survival)
library(survminer)
library(reshape)
library(stringr)
library(dplyr)
library(ggplot2)
library(readxl)
####Transforming all the variables####
#Sex
clinic$sex <- case_when(
clinic$sex == 1 ~ "male",
clinic$sex == 2 ~ "female"
)
#Comorbidity Presence?
clinic$is_comorbidity <- case_when(
clinic$is_comorbidity == 1 ~ "yes",
clinic$is_comorbidity == 0 ~ "no"
)
#Prior Chemo?
clinic$is_prior_chemo <- case_when(
clinic$is_prior_chemo == 1 ~ "yes",
clinic$is_prior_chemo == 0 ~ "no"
)
#Clinic Risk Score #-999 values aren't applicable
clinic$risk_score <- case_when(
clinic$risk_score == -999 ~ NA_real_,
TRUE ~ clinic$risk_score
)
#Stratified clinic risk score
clinic$risk_cat <- case_when(
clinic$risk_cat == 1 ~ "high",
clinic$risk_cat == 0 ~ "low",
clinic$risk_cat == -999 ~ NA_character_
)
#Extrahepatic Disease
clinic$is_extrahep_disease <- case_when(
clinic$is_extrahep_disease == 1 ~ "yes",
clinic$is_extrahep_disease == 0 ~ "no"
)
#Presence of steatosis
clinic$is_steatosis <- case_when(
clinic$is_steatosis == 1 ~ "yes",
clinic$is_steatosis == 0 ~ "no"
)
#Presence of dilated sinousoids
clinic$is_sinusoidal_dilatation <- case_when(
clinic$is_sinusoidal_dilatation == 1 ~ "yes",
clinic$is_sinusoidal_dilatation == 0 ~ "no"
)
#NASH Score
#No need to change
clinic$NASH_score
#Presence of NASH
clinic$is_NASH <- case_when(
clinic$is_NASH == 1 ~ "yes",
clinic$is_NASH == 0 ~ "no"
)
#Is Nash score at least 4
clinic$is_NASH_4_plus <- case_when(
clinic$is_NASH_4_plus == 1 ~ "yes",
clinic$is_NASH_4_plus == 0 ~ "no"
)
#Percent of total response
clinic$percent_response <- case_when(
clinic$percent_response == -999 ~ NA_real_,
TRUE ~ clinic$percent_response
)
#Percent of tumor necrosis
clinic$percent_necrosis <- case_when(
clinic$percent_necrosis == -999 ~ NA_real_,
TRUE ~ clinic$percent_necrosis
)
#Percent of Fibrosis
clinic$percent_fibrosis <- case_when(
clinic$percent_fibrosis == -999 ~ NA_real_,
TRUE ~ clinic$percent_fibrosis
)
#Is fibrosis greater than 40 percent
clinic$is_fibrosis_40_percent_plus <- case_when(
clinic$is_fibrosis_40_percent_plus == 1 ~ "high",
clinic$is_fibrosis_40_percent_plus == 0 ~ "low",
clinic$is_fibrosis_40_percent_plus == -999 ~ NA_character_
)
#Is mucin present
clinic$percent_mucin <- case_when(
clinic$percent_mucin == -999 ~ NA_real_,
TRUE ~ clinic$percent_mucin
)
#Reading in excel file
#Sheet 1 for data
clinic <- read_excel("clinical_data.xlsx")
#Good colnames
names(clinic) <- c("PID", "scout_name", "age", "sex", "is_comorbidity",
"is_prior_chemo", "risk_score",
"risk_cat", "is_extrahep_disease",
"is_steatosis",
"is_sinusoidal_dilatation",
"NASH_score", "is_NASH",
"is_NASH_4_plus", "percent_response",
"percent_necrosis", "percent_fibrosis",
"is_fibrosis_40_percent_plus",
"percent_mucin", "OS_months", "vital_status",
"is_recurrence",
"DFS_months", "vital_status_DFS",
"is_recurrence_in_liver",
"liver_DFS_months", "vital_status_liver_DFS",
"relevant_notes")
####Transforming all the variables####
#Sex
clinic$sex <- case_when(
clinic$sex == 1 ~ "male",
clinic$sex == 2 ~ "female"
)
#Comorbidity Presence?
clinic$is_comorbidity <- case_when(
clinic$is_comorbidity == 1 ~ "yes",
clinic$is_comorbidity == 0 ~ "no"
)
#Prior Chemo?
clinic$is_prior_chemo <- case_when(
clinic$is_prior_chemo == 1 ~ "yes",
clinic$is_prior_chemo == 0 ~ "no"
)
#Clinic Risk Score #-999 values aren't applicable
clinic$risk_score <- case_when(
clinic$risk_score == -999 ~ NA_real_,
TRUE ~ clinic$risk_score
)
#Stratified clinic risk score
clinic$risk_cat <- case_when(
clinic$risk_cat == 1 ~ "high",
clinic$risk_cat == 0 ~ "low",
clinic$risk_cat == -999 ~ NA_character_
)
#Extrahepatic Disease
clinic$is_extrahep_disease <- case_when(
clinic$is_extrahep_disease == 1 ~ "yes",
clinic$is_extrahep_disease == 0 ~ "no"
)
#Presence of steatosis
clinic$is_steatosis <- case_when(
clinic$is_steatosis == 1 ~ "yes",
clinic$is_steatosis == 0 ~ "no"
)
#Presence of dilated sinousoids
clinic$is_sinusoidal_dilatation <- case_when(
clinic$is_sinusoidal_dilatation == 1 ~ "yes",
clinic$is_sinusoidal_dilatation == 0 ~ "no"
)
#NASH Score
#No need to change
clinic$NASH_score
#Presence of NASH
clinic$is_NASH <- case_when(
clinic$is_NASH == 1 ~ "yes",
clinic$is_NASH == 0 ~ "no"
)
#Is Nash score at least 4
clinic$is_NASH_4_plus <- case_when(
clinic$is_NASH_4_plus == 1 ~ "yes",
clinic$is_NASH_4_plus == 0 ~ "no"
)
#Percent of total response
clinic$percent_response <- case_when(
clinic$percent_response == -999 ~ NA_real_,
TRUE ~ clinic$percent_response
)
#Percent of tumor necrosis
clinic$percent_necrosis <- case_when(
clinic$percent_necrosis == -999 ~ NA_real_,
TRUE ~ clinic$percent_necrosis
)
#Percent of Fibrosis
clinic$percent_fibrosis <- case_when(
clinic$percent_fibrosis == -999 ~ NA_real_,
TRUE ~ clinic$percent_fibrosis
)
#Is fibrosis greater than 40 percent
clinic$is_fibrosis_40_percent_plus <- case_when(
clinic$is_fibrosis_40_percent_plus == 1 ~ "high",
clinic$is_fibrosis_40_percent_plus == 0 ~ "low",
clinic$is_fibrosis_40_percent_plus == -999 ~ NA_character_
)
#Is mucin present
clinic$percent_mucin <- case_when(
clinic$percent_mucin == -999 ~ NA_real_,
TRUE ~ clinic$percent_mucin
)
clinic$percent_mucin
